---
layout: post
title:  "关于测试的想法"
---
&emsp;&emsp;曾经，一位项目经理问我，如果你不通过测试，怎么证明你程序的正确性呢？我当时虽然头脑里面隐隐有些想法，但是没想清楚，当时我无言以对。现在，我算是想明白了。程序的正确性是由他内在的逻辑正确性保证的，而不是测试能保证的。测试仅仅是外在的检测手段，逻辑正确性才是程序正确的本质。这就可以理解，code review在某些公司比如google中为什么那么重要。测试的case一般来说覆盖越全面越好。但是我们知道，顺序执行的程序，每个步骤之间的分支个数关系是相乘的，步骤一多，就很容易造成组合爆炸。这样case测试全面几乎是不可能的。这里函数式编程的思想大可有用武之地。我的前同事就非常推崇函数式的思想。模块尽量只依赖于显式的输入，比如函数的参数，而不要依赖于其他数据，比如全局变量，对象的成员等等。这样各模块之间是独立的，可以进行独立的测试。每个模块的case，相对于组合就少很多。模块内部经过代码review，单元测试等，确保正确性。各模块间接口正确，那么可以推理，组合起来的整体也必然会正确工作。当然，这是理想情况，但是现实中如果按照这个思想去做，能让事情容易些，而且靠谱些。在保证代码内在正确性方面，算法书里面的验证方法非常有用。算法都有前提条件，后续结果，期间的不变式（invariant）等。这些验证其实是严格的思维过程。经过严格思维验证的代码是比较可靠的。
